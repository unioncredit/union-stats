{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/mathewstokes/Desktop/stats-app/components-ui/BecomeMemberCard.js\",\n    _s = $RefreshSig$();\n\nimport { Card, Button, Label } from \"@unioncredit/ui\";\nimport { useState } from \"react\";\nimport useIsMember from \"hooks/data/useIsMember\";\nimport useRegisterMember from \"hooks/payables/useRegisterMember\";\nimport handleTxError from \"util/handleTxError\";\nimport getReceipt from \"util/getReceipt\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useCongratulationsModal } from \"components-ui/modals/ContratulationsModal\";\nimport { Approval } from \"./Approval\";\nimport useMemberFee from \"hooks/data/useMemberFee\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { APPROVE_UNION_REGISTER_SIGNATURE_KEY, PermitType } from \"constants/app\";\nimport useUserContract from \"hooks/contracts/useUserContract\";\nimport useUnionSymbol from \"hooks/useUnionSymbol\";\nimport { formatUnits } from \"@ethersproject/units\";\nimport useTokenBalance from \"hooks/data/useTokenBalance\";\nexport function BecomeMemberCard(_ref) {\n  _s();\n\n  var disabled = _ref.disabled;\n\n  var _useState = useState(false),\n      registering = _useState[0],\n      setRegistering = _useState[1];\n\n  var _useWeb3React = useWeb3React(),\n      library = _useWeb3React.library;\n\n  var userManager = useUserContract();\n  var UNION = useCurrentToken(\"UNION\");\n\n  var _useUnionSymbol = useUnionSymbol(),\n      unionSymbol = _useUnionSymbol.data;\n\n  var registerMember = useRegisterMember();\n\n  var _useMemberFee = useMemberFee(),\n      memberFee = _useMemberFee.data;\n\n  var _useIsMember = useIsMember(),\n      _useIsMember$data = _useIsMember.data,\n      isMember = _useIsMember$data === void 0 ? null : _useIsMember$data;\n\n  var _useCongratulationsMo = useCongratulationsModal(),\n      openCongratulationsModal = _useCongratulationsMo.open;\n\n  var _useTokenBalance = useTokenBalance(UNION),\n      _useTokenBalance$data = _useTokenBalance.data,\n      unionBalance = _useTokenBalance$data === void 0 ? 0.0 : _useTokenBalance$data;\n\n  var handleRegister = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$registerMember, hash;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              setRegistering(true);\n              _context.next = 4;\n              return registerMember();\n\n            case 4:\n              _yield$registerMember = _context.sent;\n              hash = _yield$registerMember.hash;\n              _context.next = 8;\n              return getReceipt(hash, library);\n\n            case 8:\n              openCongratulationsModal();\n              setRegistering(false);\n              _context.next = 16;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](0);\n              setRegistering(false);\n              handleTxError(_context.t0);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 12]]);\n    }));\n\n    return function handleRegister() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var displayMemberFee = memberFee ? formatUnits(memberFee.toString(), 18) : \"0\";\n  var hasEnoughUnion = unionBalance >= Number(displayMemberFee);\n  return /*#__PURE__*/_jsxDEV(Card, {\n    size: \"fluid\",\n    children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n      title: \"Pay membership fee\",\n      subTitle: \"To finalise the membership process, you\\u2019ll need to burn \".concat(displayMemberFee, \" UNION token. This will activate your account and enable access to your starting credit limit.\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n      children: [/*#__PURE__*/_jsxDEV(Approval, {\n        label: \"Approve \".concat(unionSymbol, \" for Membership\"),\n        disabled: disabled,\n        amount: memberFee || \"0\",\n        tokenAddress: UNION,\n        spender: userManager.address,\n        signatureKey: APPROVE_UNION_REGISTER_SIGNATURE_KEY,\n        permitType: PermitType.ERC2612,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          fluid: true,\n          label: \"Burn \".concat(displayMemberFee, \" \").concat(unionSymbol),\n          disabled: isMember || disabled || !hasEnoughUnion,\n          loading: registering,\n          onClick: handleRegister\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Label, {\n        as: \"p\",\n        mt: \"12px\",\n        mb: 0,\n        align: \"center\",\n        grey: 400,\n        children: \"Complete step 1 & 2 before paying membership\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BecomeMemberCard, \"M0WMcCJvjbwPE/5KI5vn0ydbA24=\", false, function () {\n  return [useWeb3React, useUserContract, useCurrentToken, useUnionSymbol, useRegisterMember, useMemberFee, useIsMember, useCongratulationsModal, useTokenBalance];\n});\n\n_c = BecomeMemberCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"BecomeMemberCard\");","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/components-ui/BecomeMemberCard.js"],"names":["Card","Button","Label","useState","useIsMember","useRegisterMember","handleTxError","getReceipt","useWeb3React","useCongratulationsModal","Approval","useMemberFee","useCurrentToken","APPROVE_UNION_REGISTER_SIGNATURE_KEY","PermitType","useUserContract","useUnionSymbol","formatUnits","useTokenBalance","BecomeMemberCard","disabled","registering","setRegistering","library","userManager","UNION","unionSymbol","data","registerMember","memberFee","isMember","openCongratulationsModal","open","unionBalance","handleRegister","hash","displayMemberFee","toString","hasEnoughUnion","Number","address","ERC2612"],"mappings":"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","sourcesContent":["import { Card, Button, Label } from \"@unioncredit/ui\";\nimport { useState } from \"react\";\nimport useIsMember from \"hooks/data/useIsMember\";\nimport useRegisterMember from \"hooks/payables/useRegisterMember\";\nimport handleTxError from \"util/handleTxError\";\nimport getReceipt from \"util/getReceipt\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useCongratulationsModal } from \"components-ui/modals/ContratulationsModal\";\nimport { Approval } from \"./Approval\";\nimport useMemberFee from \"hooks/data/useMemberFee\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport {\n  APPROVE_UNION_REGISTER_SIGNATURE_KEY,\n  PermitType,\n} from \"constants/app\";\nimport useUserContract from \"hooks/contracts/useUserContract\";\nimport useUnionSymbol from \"hooks/useUnionSymbol\";\nimport { formatUnits } from \"@ethersproject/units\";\nimport useTokenBalance from \"hooks/data/useTokenBalance\";\n\nexport function BecomeMemberCard({ disabled }) {\n  const [registering, setRegistering] = useState(false);\n\n  const { library } = useWeb3React();\n  const userManager = useUserContract();\n  const UNION = useCurrentToken(\"UNION\");\n  const { data: unionSymbol } = useUnionSymbol();\n  const registerMember = useRegisterMember();\n  const { data: memberFee } = useMemberFee();\n  const { data: isMember = null } = useIsMember();\n  const { open: openCongratulationsModal } = useCongratulationsModal();\n  const { data: unionBalance = 0.0 } = useTokenBalance(UNION);\n\n  const handleRegister = async () => {\n    try {\n      setRegistering(true);\n      const { hash } = await registerMember();\n      await getReceipt(hash, library);\n      openCongratulationsModal();\n      setRegistering(false);\n    } catch (err) {\n      setRegistering(false);\n      handleTxError(err);\n    }\n  };\n\n  const displayMemberFee = memberFee\n    ? formatUnits(memberFee.toString(), 18)\n    : \"0\";\n\n  const hasEnoughUnion = unionBalance >= Number(displayMemberFee);\n\n  return (\n    <Card size=\"fluid\">\n      <Card.Header\n        title=\"Pay membership fee\"\n        subTitle={`To finalise the membership process, you’ll need to burn ${displayMemberFee} UNION token. This will activate your account and enable access to your starting credit limit.`}\n      />\n      <Card.Body>\n        <Approval\n          label={`Approve ${unionSymbol} for Membership`}\n          disabled={disabled}\n          amount={memberFee || \"0\"}\n          tokenAddress={UNION}\n          spender={userManager.address}\n          signatureKey={APPROVE_UNION_REGISTER_SIGNATURE_KEY}\n          permitType={PermitType.ERC2612}\n        >\n          <Button\n            fluid\n            label={`Burn ${displayMemberFee} ${unionSymbol}`}\n            disabled={isMember || disabled || !hasEnoughUnion}\n            loading={registering}\n            onClick={handleRegister}\n          />\n        </Approval>\n        <Label as=\"p\" mt=\"12px\" mb={0} align=\"center\" grey={400}>\n          Complete step 1 & 2 before paying membership\n        </Label>\n      </Card.Body>\n    </Card>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}