{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\n\nvar _jsxFileName = \"/Users/mathewstokes/Desktop/stats-app/components-ui/AddressInput.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport EnsIcon from \"@unioncredit/ui/lib/icons/ens.svg\";\nimport makeBlockie from \"ethereum-blockies-base64\";\nimport { Input, Box, Label, LoadingSpinner, Avatar } from \"@unioncredit/ui\";\nimport { useRef, useState } from \"react\";\nimport { fetchENS } from \"fetchers/fetchEns\";\nimport styles from \"./AddressInput.module.css\";\nimport errorMessages from \"util/errorMessages\";\nimport validateAddress from \"util/validateAddress\";\nexport var generateHandleChange = function generateHandleChange(_ref) {\n  var clearErrors = _ref.clearErrors,\n      setValue = _ref.setValue,\n      setError = _ref.setError,\n      validate = _ref.validate;\n\n  var validateAddressInput = function validateAddressInput(address) {\n    if (!address) return errorMessages.required;\n\n    if (validate) {\n      var res = validate(address);\n      if (res !== true) return res;\n    }\n\n    if (address.startsWith(\"0x\")) return validateAddress(address);\n    if (address.endsWith(\".eth\")) return true;\n    return errorMessages.validAddressOrEns;\n  };\n\n  return function (value) {\n    clearErrors(\"address\");\n\n    var setAddress = function setAddress(address) {\n      setValue(\"address\", address, {\n        shouldDirty: true,\n        shouldValidate: true\n      });\n    };\n\n    var addressError = validateAddressInput(value);\n\n    if (addressError !== true) {\n      setError(\"address\", {\n        message: addressError\n      });\n      return;\n    }\n\n    setAddress(value);\n  };\n};\nexport var AddressInput = function AddressInput(_ref2) {\n  _s();\n\n  var onChange = _ref2.onChange,\n      error = _ref2.error,\n      defaultValue = _ref2.defaultValue,\n      props = _objectWithoutProperties(_ref2, [\"onChange\", \"error\", \"defaultValue\"]);\n\n  var timer = useRef(null);\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var _useState2 = useState(null),\n      ensData = _useState2[0],\n      setEnsData = _useState2[1];\n\n  var handleChange = function handleChange(event) {\n    setLoading(true);\n    setEnsData(null);\n    timer.current && clearTimeout(timer.current);\n    timer.current = setTimeout( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var input, ensData, inputIsENS, formValue;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              input = event.target.value;\n              _context.next = 3;\n              return fetchENS(input);\n\n            case 3:\n              ensData = _context.sent;\n              inputIsENS = input.endsWith(\".eth\");\n              setEnsData(_objectSpread(_objectSpread({}, ensData), {}, {\n                inputIsENS: inputIsENS\n              }));\n              formValue = inputIsENS ? ensData.address : input;\n              onChange && onChange(formValue);\n              setLoading(false);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })), 1000);\n  };\n\n  var inputError = (ensData === null || ensData === void 0 ? void 0 : ensData.inputIsENS) && !ensData.address && \"ENS doesn’t resolve to an address\" || !loading && error;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.addressInput,\n    children: /*#__PURE__*/_jsxDEV(Input, _objectSpread(_objectSpread({}, props), {}, {\n      onChange: handleChange,\n      defaultValue: defaultValue,\n      error: inputError,\n      suffix: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.loadingSpinner,\n        children: /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 15\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }, _this) : ensData !== null && ensData !== void 0 && ensData.inputIsENS ? /*#__PURE__*/_jsxDEV(EnsIcon, {\n        className: inputError ? styles.ensIconError : styles.ensIconValid\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }, _this) : null,\n      caption: ensData ? /*#__PURE__*/_jsxDEV(Box, {\n        direction: \"horizontal\",\n        align: \"center\",\n        mt: \"4px\",\n        children: [(ensData.avatar || ensData.address) && /*#__PURE__*/_jsxDEV(Avatar, {\n          size: 16,\n          src: ensData.avatar || makeBlockie(ensData.address)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }, _this), \" \", /*#__PURE__*/_jsxDEV(Label, {\n          mb: 0,\n          mt: 0,\n          ml: \"4px\",\n          size: \"small\",\n          children: ensData.inputIsENS ? ensData.address : ensData.name ? ensData.name : \"No ENS Registered\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: \"22px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }, _this)\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(AddressInput, \"kIN/ey4L4Byi45xogP5hl22vFSA=\");\n\n_c = AddressInput;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddressInput\");","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/components-ui/AddressInput.js"],"names":["EnsIcon","makeBlockie","Input","Box","Label","LoadingSpinner","Avatar","useRef","useState","fetchENS","styles","errorMessages","validateAddress","generateHandleChange","clearErrors","setValue","setError","validate","validateAddressInput","address","required","res","startsWith","endsWith","validAddressOrEns","value","setAddress","shouldDirty","shouldValidate","addressError","message","AddressInput","onChange","error","defaultValue","props","timer","loading","setLoading","ensData","setEnsData","handleChange","event","current","clearTimeout","setTimeout","input","target","inputIsENS","formValue","inputError","addressInput","loadingSpinner","ensIconError","ensIconValid","avatar","name","height"],"mappings":"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","sourcesContent":["import EnsIcon from \"@unioncredit/ui/lib/icons/ens.svg\";\nimport makeBlockie from \"ethereum-blockies-base64\";\nimport { Input, Box, Label, LoadingSpinner, Avatar } from \"@unioncredit/ui\";\n\nimport { useRef, useState } from \"react\";\nimport { fetchENS } from \"fetchers/fetchEns\";\n\nimport styles from \"./AddressInput.module.css\";\nimport errorMessages from \"util/errorMessages\";\nimport validateAddress from \"util/validateAddress\";\n\nexport const generateHandleChange = ({\n  clearErrors,\n  setValue,\n  setError,\n  validate,\n}) => {\n  const validateAddressInput = (address) => {\n    if (!address) return errorMessages.required;\n    if (validate) {\n      const res = validate(address);\n      if (res !== true) return res;\n    }\n    if (address.startsWith(\"0x\")) return validateAddress(address);\n    if (address.endsWith(\".eth\")) return true;\n    return errorMessages.validAddressOrEns;\n  };\n\n  return (value) => {\n    clearErrors(\"address\");\n    const setAddress = (address) => {\n      setValue(\"address\", address, { shouldDirty: true, shouldValidate: true });\n    };\n\n    const addressError = validateAddressInput(value);\n    if (addressError !== true) {\n      setError(\"address\", { message: addressError });\n      return;\n    }\n\n    setAddress(value);\n  };\n};\n\nexport const AddressInput = ({ onChange, error, defaultValue, ...props }) => {\n  const timer = useRef(null);\n  const [loading, setLoading] = useState(false);\n  const [ensData, setEnsData] = useState(null);\n\n  const handleChange = (event) => {\n    setLoading(true);\n    setEnsData(null);\n\n    timer.current && clearTimeout(timer.current);\n    timer.current = setTimeout(async () => {\n      const input = event.target.value;\n      const ensData = await fetchENS(input);\n      const inputIsENS = input.endsWith(\".eth\");\n\n      setEnsData({ ...ensData, inputIsENS });\n\n      const formValue = inputIsENS ? ensData.address : input;\n      onChange && onChange(formValue);\n      setLoading(false);\n    }, 1000);\n  };\n\n  const inputError =\n    (ensData?.inputIsENS &&\n      !ensData.address &&\n      \"ENS doesn’t resolve to an address\") ||\n    (!loading && error);\n\n  return (\n    <div className={styles.addressInput}>\n      <Input\n        {...props}\n        onChange={handleChange}\n        defaultValue={defaultValue}\n        error={inputError}\n        suffix={\n          loading ? (\n            <div className={styles.loadingSpinner}>\n              <LoadingSpinner />\n            </div>\n          ) : ensData?.inputIsENS ? (\n            <EnsIcon\n              className={inputError ? styles.ensIconError : styles.ensIconValid}\n            />\n          ) : null\n        }\n        caption={\n          ensData ? (\n            <Box direction=\"horizontal\" align=\"center\" mt=\"4px\">\n              {(ensData.avatar || ensData.address) && (\n                <Avatar\n                  size={16}\n                  src={ensData.avatar || makeBlockie(ensData.address)}\n                />\n              )}{\" \"}\n              <Label mb={0} mt={0} ml=\"4px\" size=\"small\">\n                {ensData.inputIsENS\n                  ? ensData.address\n                  : ensData.name\n                  ? ensData.name\n                  : \"No ENS Registered\"}\n              </Label>\n            </Box>\n          ) : (\n            <div style={{ height: \"22px\" }} />\n          )\n        }\n      />\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}