{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/mathewstokes/Desktop/stats-app/components-ui/AddressInput.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport EnsIcon from \"@unioncredit/ui/lib/icons/ens.svg\";\nimport makeBlockie from \"ethereum-blockies-base64\";\nimport { Input, Box, Label, LoadingSpinner, Avatar } from \"@unioncredit/ui\";\nimport { useRef, useState } from \"react\";\nimport { fetchENS } from \"fetchers/fetchEns\";\nimport styles from \"./AddressInput.module.css\";\nimport errorMessages from \"util/errorMessages\";\nimport validateAddress from \"util/validateAddress\";\nexport const generateHandleChange = ({\n  clearErrors,\n  setValue,\n  setError,\n  validate\n}) => {\n  const validateAddressInput = address => {\n    if (!address) return errorMessages.required;\n\n    if (validate) {\n      const res = validate(address);\n      if (res !== true) return res;\n    }\n\n    if (address.startsWith(\"0x\")) return validateAddress(address);\n    if (address.endsWith(\".eth\")) return true;\n    return errorMessages.validAddressOrEns;\n  };\n\n  return value => {\n    clearErrors(\"address\");\n\n    const setAddress = address => {\n      setValue(\"address\", address, {\n        shouldDirty: true,\n        shouldValidate: true\n      });\n    };\n\n    const addressError = validateAddressInput(value);\n\n    if (addressError !== true) {\n      setError(\"address\", {\n        message: addressError\n      });\n      return;\n    }\n\n    setAddress(value);\n  };\n};\nexport const AddressInput = (_ref) => {\n  let {\n    onChange,\n    error,\n    defaultValue\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"onChange\", \"error\", \"defaultValue\"]);\n\n  const timer = useRef(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: ensData,\n    1: setEnsData\n  } = useState(null);\n\n  const handleChange = event => {\n    setLoading(true);\n    setEnsData(null);\n    timer.current && clearTimeout(timer.current);\n    timer.current = setTimeout(async () => {\n      const input = event.target.value;\n      const ensData = await fetchENS(input);\n      const inputIsENS = input.endsWith(\".eth\");\n      setEnsData(_objectSpread(_objectSpread({}, ensData), {}, {\n        inputIsENS\n      }));\n      const formValue = inputIsENS ? ensData.address : input;\n      onChange && onChange(formValue);\n      setLoading(false);\n    }, 1000);\n  };\n\n  const inputError = (ensData === null || ensData === void 0 ? void 0 : ensData.inputIsENS) && !ensData.address && \"ENS doesn’t resolve to an address\" || !loading && error;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.addressInput,\n    children: /*#__PURE__*/_jsxDEV(Input, _objectSpread(_objectSpread({}, props), {}, {\n      onChange: handleChange,\n      defaultValue: defaultValue,\n      error: inputError,\n      suffix: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.loadingSpinner,\n        children: /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 13\n      }, this) : ensData !== null && ensData !== void 0 && ensData.inputIsENS ? /*#__PURE__*/_jsxDEV(EnsIcon, {\n        className: inputError ? styles.ensIconError : styles.ensIconValid\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }, this) : null,\n      caption: ensData ? /*#__PURE__*/_jsxDEV(Box, {\n        direction: \"horizontal\",\n        align: \"center\",\n        mt: \"4px\",\n        children: [(ensData.avatar || ensData.address) && /*#__PURE__*/_jsxDEV(Avatar, {\n          size: 16,\n          src: ensData.avatar || makeBlockie(ensData.address)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 17\n        }, this), \" \", /*#__PURE__*/_jsxDEV(Label, {\n          mb: 0,\n          mt: 0,\n          ml: \"4px\",\n          size: \"small\",\n          children: ensData.inputIsENS ? ensData.address : ensData.name ? ensData.name : \"No ENS Registered\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: \"22px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }, this)\n    }), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n};","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/components-ui/AddressInput.js"],"names":["EnsIcon","makeBlockie","Input","Box","Label","LoadingSpinner","Avatar","useRef","useState","fetchENS","styles","errorMessages","validateAddress","generateHandleChange","clearErrors","setValue","setError","validate","validateAddressInput","address","required","res","startsWith","endsWith","validAddressOrEns","value","setAddress","shouldDirty","shouldValidate","addressError","message","AddressInput","onChange","error","defaultValue","props","timer","loading","setLoading","ensData","setEnsData","handleChange","event","current","clearTimeout","setTimeout","input","target","inputIsENS","formValue","inputError","addressInput","loadingSpinner","ensIconError","ensIconValid","avatar","name","height"],"mappings":";;;;;;;;;;;;;AAAA,OAAOA,OAAP,MAAoB,mCAApB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,SAASC,KAAT,EAAgBC,GAAhB,EAAqBC,KAArB,EAA4BC,cAA5B,EAA4CC,MAA5C,QAA0D,iBAA1D;AAEA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,OAAjC;AACA,SAASC,QAAT,QAAyB,mBAAzB;AAEA,OAAOC,MAAP,MAAmB,2BAAnB;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AACA,OAAOC,eAAP,MAA4B,sBAA5B;AAEA,OAAO,MAAMC,oBAAoB,GAAG,CAAC;AACnCC,EAAAA,WADmC;AAEnCC,EAAAA,QAFmC;AAGnCC,EAAAA,QAHmC;AAInCC,EAAAA;AAJmC,CAAD,KAK9B;AACJ,QAAMC,oBAAoB,GAAIC,OAAD,IAAa;AACxC,QAAI,CAACA,OAAL,EAAc,OAAOR,aAAa,CAACS,QAArB;;AACd,QAAIH,QAAJ,EAAc;AACZ,YAAMI,GAAG,GAAGJ,QAAQ,CAACE,OAAD,CAApB;AACA,UAAIE,GAAG,KAAK,IAAZ,EAAkB,OAAOA,GAAP;AACnB;;AACD,QAAIF,OAAO,CAACG,UAAR,CAAmB,IAAnB,CAAJ,EAA8B,OAAOV,eAAe,CAACO,OAAD,CAAtB;AAC9B,QAAIA,OAAO,CAACI,QAAR,CAAiB,MAAjB,CAAJ,EAA8B,OAAO,IAAP;AAC9B,WAAOZ,aAAa,CAACa,iBAArB;AACD,GATD;;AAWA,SAAQC,KAAD,IAAW;AAChBX,IAAAA,WAAW,CAAC,SAAD,CAAX;;AACA,UAAMY,UAAU,GAAIP,OAAD,IAAa;AAC9BJ,MAAAA,QAAQ,CAAC,SAAD,EAAYI,OAAZ,EAAqB;AAAEQ,QAAAA,WAAW,EAAE,IAAf;AAAqBC,QAAAA,cAAc,EAAE;AAArC,OAArB,CAAR;AACD,KAFD;;AAIA,UAAMC,YAAY,GAAGX,oBAAoB,CAACO,KAAD,CAAzC;;AACA,QAAII,YAAY,KAAK,IAArB,EAA2B;AACzBb,MAAAA,QAAQ,CAAC,SAAD,EAAY;AAAEc,QAAAA,OAAO,EAAED;AAAX,OAAZ,CAAR;AACA;AACD;;AAEDH,IAAAA,UAAU,CAACD,KAAD,CAAV;AACD,GAbD;AAcD,CA/BM;AAiCP,OAAO,MAAMM,YAAY,GAAG,UAAiD;AAAA,MAAhD;AAAEC,IAAAA,QAAF;AAAYC,IAAAA,KAAZ;AAAmBC,IAAAA;AAAnB,GAAgD;AAAA,MAAZC,KAAY;;AAC3E,QAAMC,KAAK,GAAG7B,MAAM,CAAC,IAAD,CAApB;AACA,QAAM;AAAA,OAAC8B,OAAD;AAAA,OAAUC;AAAV,MAAwB9B,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM;AAAA,OAAC+B,OAAD;AAAA,OAAUC;AAAV,MAAwBhC,QAAQ,CAAC,IAAD,CAAtC;;AAEA,QAAMiC,YAAY,GAAIC,KAAD,IAAW;AAC9BJ,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAE,IAAAA,UAAU,CAAC,IAAD,CAAV;AAEAJ,IAAAA,KAAK,CAACO,OAAN,IAAiBC,YAAY,CAACR,KAAK,CAACO,OAAP,CAA7B;AACAP,IAAAA,KAAK,CAACO,OAAN,GAAgBE,UAAU,CAAC,YAAY;AACrC,YAAMC,KAAK,GAAGJ,KAAK,CAACK,MAAN,CAAatB,KAA3B;AACA,YAAMc,OAAO,GAAG,MAAM9B,QAAQ,CAACqC,KAAD,CAA9B;AACA,YAAME,UAAU,GAAGF,KAAK,CAACvB,QAAN,CAAe,MAAf,CAAnB;AAEAiB,MAAAA,UAAU,iCAAMD,OAAN;AAAeS,QAAAA;AAAf,SAAV;AAEA,YAAMC,SAAS,GAAGD,UAAU,GAAGT,OAAO,CAACpB,OAAX,GAAqB2B,KAAjD;AACAd,MAAAA,QAAQ,IAAIA,QAAQ,CAACiB,SAAD,CAApB;AACAX,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD,KAVyB,EAUvB,IAVuB,CAA1B;AAWD,GAhBD;;AAkBA,QAAMY,UAAU,GACb,CAAAX,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO,CAAES,UAAT,KACC,CAACT,OAAO,CAACpB,OADV,IAEC,mCAFF,IAGC,CAACkB,OAAD,IAAYJ,KAJf;AAMA,sBACE;AAAK,IAAA,SAAS,EAAEvB,MAAM,CAACyC,YAAvB;AAAA,2BACE,QAAC,KAAD,kCACMhB,KADN;AAEE,MAAA,QAAQ,EAAEM,YAFZ;AAGE,MAAA,YAAY,EAAEP,YAHhB;AAIE,MAAA,KAAK,EAAEgB,UAJT;AAKE,MAAA,MAAM,EACJb,OAAO,gBACL;AAAK,QAAA,SAAS,EAAE3B,MAAM,CAAC0C,cAAvB;AAAA,+BACE,QAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADK,GAIHb,OAAO,SAAP,IAAAA,OAAO,WAAP,IAAAA,OAAO,CAAES,UAAT,gBACF,QAAC,OAAD;AACE,QAAA,SAAS,EAAEE,UAAU,GAAGxC,MAAM,CAAC2C,YAAV,GAAyB3C,MAAM,CAAC4C;AADvD;AAAA;AAAA;AAAA;AAAA,cADE,GAIA,IAdR;AAgBE,MAAA,OAAO,EACLf,OAAO,gBACL,QAAC,GAAD;AAAK,QAAA,SAAS,EAAC,YAAf;AAA4B,QAAA,KAAK,EAAC,QAAlC;AAA2C,QAAA,EAAE,EAAC,KAA9C;AAAA,mBACG,CAACA,OAAO,CAACgB,MAAR,IAAkBhB,OAAO,CAACpB,OAA3B,kBACC,QAAC,MAAD;AACE,UAAA,IAAI,EAAE,EADR;AAEE,UAAA,GAAG,EAAEoB,OAAO,CAACgB,MAAR,IAAkBtD,WAAW,CAACsC,OAAO,CAACpB,OAAT;AAFpC;AAAA;AAAA;AAAA;AAAA,gBAFJ,EAMK,GANL,eAOE,QAAC,KAAD;AAAO,UAAA,EAAE,EAAE,CAAX;AAAc,UAAA,EAAE,EAAE,CAAlB;AAAqB,UAAA,EAAE,EAAC,KAAxB;AAA8B,UAAA,IAAI,EAAC,OAAnC;AAAA,oBACGoB,OAAO,CAACS,UAAR,GACGT,OAAO,CAACpB,OADX,GAEGoB,OAAO,CAACiB,IAAR,GACAjB,OAAO,CAACiB,IADR,GAEA;AALN;AAAA;AAAA;AAAA;AAAA,gBAPF;AAAA;AAAA;AAAA;AAAA;AAAA,cADK,gBAiBL;AAAK,QAAA,KAAK,EAAE;AAAEC,UAAAA,MAAM,EAAE;AAAV;AAAZ;AAAA;AAAA;AAAA;AAAA;AAlCN;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADF;AA0CD,CAvEM","sourcesContent":["import EnsIcon from \"@unioncredit/ui/lib/icons/ens.svg\";\nimport makeBlockie from \"ethereum-blockies-base64\";\nimport { Input, Box, Label, LoadingSpinner, Avatar } from \"@unioncredit/ui\";\n\nimport { useRef, useState } from \"react\";\nimport { fetchENS } from \"fetchers/fetchEns\";\n\nimport styles from \"./AddressInput.module.css\";\nimport errorMessages from \"util/errorMessages\";\nimport validateAddress from \"util/validateAddress\";\n\nexport const generateHandleChange = ({\n  clearErrors,\n  setValue,\n  setError,\n  validate,\n}) => {\n  const validateAddressInput = (address) => {\n    if (!address) return errorMessages.required;\n    if (validate) {\n      const res = validate(address);\n      if (res !== true) return res;\n    }\n    if (address.startsWith(\"0x\")) return validateAddress(address);\n    if (address.endsWith(\".eth\")) return true;\n    return errorMessages.validAddressOrEns;\n  };\n\n  return (value) => {\n    clearErrors(\"address\");\n    const setAddress = (address) => {\n      setValue(\"address\", address, { shouldDirty: true, shouldValidate: true });\n    };\n\n    const addressError = validateAddressInput(value);\n    if (addressError !== true) {\n      setError(\"address\", { message: addressError });\n      return;\n    }\n\n    setAddress(value);\n  };\n};\n\nexport const AddressInput = ({ onChange, error, defaultValue, ...props }) => {\n  const timer = useRef(null);\n  const [loading, setLoading] = useState(false);\n  const [ensData, setEnsData] = useState(null);\n\n  const handleChange = (event) => {\n    setLoading(true);\n    setEnsData(null);\n\n    timer.current && clearTimeout(timer.current);\n    timer.current = setTimeout(async () => {\n      const input = event.target.value;\n      const ensData = await fetchENS(input);\n      const inputIsENS = input.endsWith(\".eth\");\n\n      setEnsData({ ...ensData, inputIsENS });\n\n      const formValue = inputIsENS ? ensData.address : input;\n      onChange && onChange(formValue);\n      setLoading(false);\n    }, 1000);\n  };\n\n  const inputError =\n    (ensData?.inputIsENS &&\n      !ensData.address &&\n      \"ENS doesn’t resolve to an address\") ||\n    (!loading && error);\n\n  return (\n    <div className={styles.addressInput}>\n      <Input\n        {...props}\n        onChange={handleChange}\n        defaultValue={defaultValue}\n        error={inputError}\n        suffix={\n          loading ? (\n            <div className={styles.loadingSpinner}>\n              <LoadingSpinner />\n            </div>\n          ) : ensData?.inputIsENS ? (\n            <EnsIcon\n              className={inputError ? styles.ensIconError : styles.ensIconValid}\n            />\n          ) : null\n        }\n        caption={\n          ensData ? (\n            <Box direction=\"horizontal\" align=\"center\" mt=\"4px\">\n              {(ensData.avatar || ensData.address) && (\n                <Avatar\n                  size={16}\n                  src={ensData.avatar || makeBlockie(ensData.address)}\n                />\n              )}{\" \"}\n              <Label mb={0} mt={0} ml=\"4px\" size=\"small\">\n                {ensData.inputIsENS\n                  ? ensData.address\n                  : ensData.name\n                  ? ensData.name\n                  : \"No ENS Registered\"}\n              </Label>\n            </Box>\n          ) : (\n            <div style={{ height: \"22px\" }} />\n          )\n        }\n      />\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}