{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nimport { parseUnits } from \"@ethersproject/units\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { useCallback } from \"react\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport USER_MANAGER_ABI from \"constants/abis/userManager.json\";\nimport useMarketRegistryContract from \"../contracts/useMarketRegistryContract\";\nexport default function useAdjustTrust() {\n  _s();\n\n  var tokenAddress = useCurrentToken();\n\n  var _useWeb3React = useWeb3React(),\n      library = _useWeb3React.library;\n\n  var marketRegistryContract = useMarketRegistryContract();\n  return useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(memberAddress, amount) {\n      var trustAmount, gasLimit, userManagerContract, signer, res, userManagerAddress;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              trustAmount = parseUnits(String(amount), 18);\n              _context.prev = 1;\n              signer = library.getSigner();\n              _context.next = 5;\n              return marketRegistryContract.tokens(tokenAddress);\n\n            case 5:\n              res = _context.sent;\n              userManagerAddress = res.userManager;\n              userManagerContract = new Contract(userManagerAddress, USER_MANAGER_ABI, signer);\n              _context.next = 10;\n              return userManagerContract.estimateGas.updateTrust(memberAddress, trustAmount.toString());\n\n            case 10:\n              gasLimit = _context.sent;\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](1);\n              gasLimit = 300000;\n\n            case 16:\n              return _context.abrupt(\"return\", userManagerContract.updateTrust(memberAddress, trustAmount.toString(), {\n                gasLimit: gasLimit\n              }));\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 13]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(), [library, marketRegistryContract, tokenAddress]);\n}\n\n_s(useAdjustTrust, \"jaPtHHkf1LDy6CMVOQBGfFLMaZ4=\", false, function () {\n  return [useCurrentToken, useWeb3React, useMarketRegistryContract];\n});","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/hooks/payables/useAdjustTrust.ts"],"names":["parseUnits","useCurrentToken","useCallback","useWeb3React","Contract","USER_MANAGER_ABI","useMarketRegistryContract","useAdjustTrust","tokenAddress","library","marketRegistryContract","memberAddress","amount","trustAmount","String","signer","getSigner","tokens","res","userManagerAddress","userManager","userManagerContract","estimateGas","updateTrust","toString","gasLimit"],"mappings":";;;;;AACA,SAASA,UAAT,QAA2B,sBAA3B;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,SAASC,WAAT,QAA4B,OAA5B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,QAAT,QAAyB,0BAAzB;AACA,OAAOC,gBAAP,MAA6B,iCAA7B;AACA,OAAOC,yBAAP,MAAsC,wCAAtC;AAEA,eAAe,SAASC,cAAT,GAA0B;AAAA;;AACvC,MAAMC,YAAY,GAAGP,eAAe,EAApC;;AADuC,sBAEnBE,YAAY,EAFO;AAAA,MAE/BM,OAF+B,iBAE/BA,OAF+B;;AAGvC,MAAMC,sBAAsB,GAAGJ,yBAAyB,EAAxD;AAEA,SAAOJ,WAAW;AAAA,wEAChB,iBACES,aADF,EAEEC,MAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AAIQC,cAAAA,WAJR,GAIsBb,UAAU,CAACc,MAAM,CAACF,MAAD,CAAP,EAAiB,EAAjB,CAJhC;AAAA;AAQUG,cAAAA,MARV,GAQmBN,OAAO,CAACO,SAAR,EARnB;AAAA;AAAA,qBASsBN,sBAAsB,CAACO,MAAvB,CAA8BT,YAA9B,CATtB;;AAAA;AASUU,cAAAA,GATV;AAUUC,cAAAA,kBAVV,GAU+BD,GAAG,CAACE,WAVnC;AAWIC,cAAAA,mBAAmB,GAAG,IAAIjB,QAAJ,CACpBe,kBADoB,EAEpBd,gBAFoB,EAGpBU,MAHoB,CAAtB;AAXJ;AAAA,qBAiBqBM,mBAAmB,CAACC,WAApB,CAAgCC,WAAhC,CACfZ,aADe,EAEfE,WAAW,CAACW,QAAZ,EAFe,CAjBrB;;AAAA;AAiBIC,cAAAA,QAjBJ;AAAA;AAAA;;AAAA;AAAA;AAAA;AAsBIA,cAAAA,QAAQ,GAAG,MAAX;;AAtBJ;AAAA,+CAyBSJ,mBAAmB,CAACE,WAApB,CACLZ,aADK,EAELE,WAAW,CAACW,QAAZ,EAFK,EAGL;AACEC,gBAAAA,QAAQ,EAARA;AADF,eAHK,CAzBT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADgB;;AAAA;AAAA;AAAA;AAAA,OAkChB,CAAChB,OAAD,EAAUC,sBAAV,EAAkCF,YAAlC,CAlCgB,CAAlB;AAoCD;;GAzCuBD,c;UACDN,e,EACDE,Y,EACWG,yB","sourcesContent":["import type { TransactionResponse } from \"@ethersproject/providers\";\nimport { parseUnits } from \"@ethersproject/units\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { useCallback } from \"react\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { Contract } from \"@ethersproject/contracts\";\nimport USER_MANAGER_ABI from \"constants/abis/userManager.json\";\nimport useMarketRegistryContract from \"../contracts/useMarketRegistryContract\";\n\nexport default function useAdjustTrust() {\n  const tokenAddress = useCurrentToken();\n  const { library } = useWeb3React();\n  const marketRegistryContract = useMarketRegistryContract();\n\n  return useCallback(\n    async (\n      memberAddress: string,\n      amount: number | string\n    ): Promise<TransactionResponse> => {\n      const trustAmount = parseUnits(String(amount), 18);\n\n      let gasLimit: any, userManagerContract: Contract;\n      try {\n        const signer = library.getSigner();\n        const res = await marketRegistryContract.tokens(tokenAddress);\n        const userManagerAddress = res.userManager;\n        userManagerContract = new Contract(\n          userManagerAddress,\n          USER_MANAGER_ABI,\n          signer\n        );\n\n        gasLimit = await userManagerContract.estimateGas.updateTrust(\n          memberAddress,\n          trustAmount.toString()\n        );\n      } catch (err) {\n        gasLimit = 300000;\n      }\n\n      return userManagerContract.updateTrust(\n        memberAddress,\n        trustAmount.toString(),\n        {\n          gasLimit,\n        }\n      );\n    },\n    [library, marketRegistryContract, tokenAddress]\n  );\n}\n"]},"metadata":{},"sourceType":"module"}