{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/mathewstokes/Desktop/stats-app/components-ui/BecomeMemberCard.js\";\nimport { Card, Button, Label } from \"@unioncredit/ui\";\nimport { useState } from \"react\";\nimport useIsMember from \"hooks/data/useIsMember\";\nimport useRegisterMember from \"hooks/payables/useRegisterMember\";\nimport handleTxError from \"util/handleTxError\";\nimport getReceipt from \"util/getReceipt\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useCongratulationsModal } from \"components-ui/modals/ContratulationsModal\";\nimport { Approval } from \"./Approval\";\nimport useMemberFee from \"hooks/data/useMemberFee\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { APPROVE_UNION_REGISTER_SIGNATURE_KEY, PermitType } from \"constants/app\";\nimport useUserContract from \"hooks/contracts/useUserContract\";\nimport useUnionSymbol from \"hooks/useUnionSymbol\";\nimport { formatUnits } from \"@ethersproject/units\";\nimport useTokenBalance from \"hooks/data/useTokenBalance\";\nexport function BecomeMemberCard({\n  disabled\n}) {\n  const {\n    0: registering,\n    1: setRegistering\n  } = useState(false);\n  const {\n    library\n  } = useWeb3React();\n  const userManager = useUserContract();\n  const UNION = useCurrentToken(\"UNION\");\n  const {\n    data: unionSymbol\n  } = useUnionSymbol();\n  const registerMember = useRegisterMember();\n  const {\n    data: memberFee\n  } = useMemberFee();\n  const {\n    data: isMember = null\n  } = useIsMember();\n  const {\n    open: openCongratulationsModal\n  } = useCongratulationsModal();\n  const {\n    data: unionBalance = 0.0\n  } = useTokenBalance(UNION);\n\n  const handleRegister = async () => {\n    try {\n      setRegistering(true);\n      const {\n        hash\n      } = await registerMember();\n      await getReceipt(hash, library);\n      openCongratulationsModal();\n      setRegistering(false);\n    } catch (err) {\n      setRegistering(false);\n      handleTxError(err);\n    }\n  };\n\n  const displayMemberFee = memberFee ? formatUnits(memberFee.toString(), 18) : \"0\";\n  const hasEnoughUnion = unionBalance >= Number(displayMemberFee);\n  return /*#__PURE__*/_jsxDEV(Card, {\n    size: \"fluid\",\n    children: [/*#__PURE__*/_jsxDEV(Card.Header, {\n      title: \"Pay membership fee\",\n      subTitle: `To finalise the membership process, youâ€™ll need to burn ${displayMemberFee} UNION token. This will activate your account and enable access to your starting credit limit.`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Card.Body, {\n      children: [/*#__PURE__*/_jsxDEV(Approval, {\n        label: `Approve ${unionSymbol} for Membership`,\n        disabled: disabled,\n        amount: memberFee || \"0\",\n        tokenAddress: UNION,\n        spender: userManager.address,\n        signatureKey: APPROVE_UNION_REGISTER_SIGNATURE_KEY,\n        permitType: PermitType.ERC2612,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          fluid: true,\n          label: `Burn ${displayMemberFee} ${unionSymbol}`,\n          disabled: isMember || disabled || !hasEnoughUnion,\n          loading: registering,\n          onClick: handleRegister\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Label, {\n        as: \"p\",\n        mt: \"12px\",\n        mb: 0,\n        align: \"center\",\n        grey: 400,\n        children: \"Complete step 1 & 2 before paying membership\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/components-ui/BecomeMemberCard.js"],"names":["Card","Button","Label","useState","useIsMember","useRegisterMember","handleTxError","getReceipt","useWeb3React","useCongratulationsModal","Approval","useMemberFee","useCurrentToken","APPROVE_UNION_REGISTER_SIGNATURE_KEY","PermitType","useUserContract","useUnionSymbol","formatUnits","useTokenBalance","BecomeMemberCard","disabled","registering","setRegistering","library","userManager","UNION","data","unionSymbol","registerMember","memberFee","isMember","open","openCongratulationsModal","unionBalance","handleRegister","hash","err","displayMemberFee","toString","hasEnoughUnion","Number","address","ERC2612"],"mappings":"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","sourcesContent":["import { Card, Button, Label } from \"@unioncredit/ui\";\nimport { useState } from \"react\";\nimport useIsMember from \"hooks/data/useIsMember\";\nimport useRegisterMember from \"hooks/payables/useRegisterMember\";\nimport handleTxError from \"util/handleTxError\";\nimport getReceipt from \"util/getReceipt\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { useCongratulationsModal } from \"components-ui/modals/ContratulationsModal\";\nimport { Approval } from \"./Approval\";\nimport useMemberFee from \"hooks/data/useMemberFee\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport {\n  APPROVE_UNION_REGISTER_SIGNATURE_KEY,\n  PermitType,\n} from \"constants/app\";\nimport useUserContract from \"hooks/contracts/useUserContract\";\nimport useUnionSymbol from \"hooks/useUnionSymbol\";\nimport { formatUnits } from \"@ethersproject/units\";\nimport useTokenBalance from \"hooks/data/useTokenBalance\";\n\nexport function BecomeMemberCard({ disabled }) {\n  const [registering, setRegistering] = useState(false);\n\n  const { library } = useWeb3React();\n  const userManager = useUserContract();\n  const UNION = useCurrentToken(\"UNION\");\n  const { data: unionSymbol } = useUnionSymbol();\n  const registerMember = useRegisterMember();\n  const { data: memberFee } = useMemberFee();\n  const { data: isMember = null } = useIsMember();\n  const { open: openCongratulationsModal } = useCongratulationsModal();\n  const { data: unionBalance = 0.0 } = useTokenBalance(UNION);\n\n  const handleRegister = async () => {\n    try {\n      setRegistering(true);\n      const { hash } = await registerMember();\n      await getReceipt(hash, library);\n      openCongratulationsModal();\n      setRegistering(false);\n    } catch (err) {\n      setRegistering(false);\n      handleTxError(err);\n    }\n  };\n\n  const displayMemberFee = memberFee\n    ? formatUnits(memberFee.toString(), 18)\n    : \"0\";\n\n  const hasEnoughUnion = unionBalance >= Number(displayMemberFee);\n\n  return (\n    <Card size=\"fluid\">\n      <Card.Header\n        title=\"Pay membership fee\"\n        subTitle={`To finalise the membership process, youâ€™ll need to burn ${displayMemberFee} UNION token. This will activate your account and enable access to your starting credit limit.`}\n      />\n      <Card.Body>\n        <Approval\n          label={`Approve ${unionSymbol} for Membership`}\n          disabled={disabled}\n          amount={memberFee || \"0\"}\n          tokenAddress={UNION}\n          spender={userManager.address}\n          signatureKey={APPROVE_UNION_REGISTER_SIGNATURE_KEY}\n          permitType={PermitType.ERC2612}\n        >\n          <Button\n            fluid\n            label={`Burn ${displayMemberFee} ${unionSymbol}`}\n            disabled={isMember || disabled || !hasEnoughUnion}\n            loading={registering}\n            onClick={handleRegister}\n          />\n        </Approval>\n        <Label as=\"p\" mt=\"12px\" mb={0} align=\"center\" grey={400}>\n          Complete step 1 & 2 before paying membership\n        </Label>\n      </Card.Body>\n    </Card>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}