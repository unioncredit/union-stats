{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mathewstokes/Desktop/stats-app/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nimport { Contract } from \"@ethersproject/contracts\";\nimport { parseUnits } from \"@ethersproject/units\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport U_TOKENT_ABI from \"constants/abis/uToken.json\";\nimport useMarketRegistryContract from \"hooks/contracts/useMarketRegistryContract\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { useCallback } from \"react\";\nexport default function useBorrow() {\n  _s();\n\n  var _useWeb3React = useWeb3React(),\n      library = _useWeb3React.library;\n\n  var tokenAddress = useCurrentToken();\n  var marketRegistryContract = useMarketRegistryContract();\n  return useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(amount) {\n      var res, uTokenAddress, uTokenContract, borrowAmount, gasLimit, estimateGas;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return marketRegistryContract.tokens(tokenAddress);\n\n            case 2:\n              res = _context.sent;\n              uTokenAddress = res.uToken;\n              uTokenContract = new Contract(uTokenAddress, U_TOKENT_ABI, library.getSigner());\n              borrowAmount = parseUnits(String(amount), 18);\n              _context.prev = 6;\n              _context.next = 9;\n              return uTokenContract.estimateGas.borrow(borrowAmount.toString());\n\n            case 9:\n              estimateGas = _context.sent;\n              gasLimit = (parseFloat(estimateGas.toString()) * 1.1).toFixed(0);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](6);\n              gasLimit = 1000000;\n\n            case 16:\n              return _context.abrupt(\"return\", uTokenContract.borrow(borrowAmount.toString(), {\n                gasLimit: gasLimit\n              }));\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 13]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(), [tokenAddress, marketRegistryContract]);\n}\n\n_s(useBorrow, \"7nEg0hggtt3ZnuPvuQg+Fh0K4Dw=\", false, function () {\n  return [useWeb3React, useCurrentToken, useMarketRegistryContract];\n});","map":{"version":3,"sources":["/Users/mathewstokes/Desktop/stats-app/hooks/payables/useBorrow.ts"],"names":["Contract","parseUnits","useWeb3React","U_TOKENT_ABI","useMarketRegistryContract","useCurrentToken","useCallback","useBorrow","library","tokenAddress","marketRegistryContract","amount","tokens","res","uTokenAddress","uToken","uTokenContract","getSigner","borrowAmount","String","estimateGas","borrow","toString","gasLimit","parseFloat","toFixed"],"mappings":";;;;;AAAA,SAASA,QAAT,QAAyB,0BAAzB;AAEA,SAASC,UAAT,QAA2B,sBAA3B;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,OAAOC,YAAP,MAAyB,4BAAzB;AACA,OAAOC,yBAAP,MAAsC,2CAAtC;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,SAASC,WAAT,QAA4B,OAA5B;AAEA,eAAe,SAASC,SAAT,GAAqB;AAAA;;AAAA,sBACdL,YAAY,EADE;AAAA,MAC1BM,OAD0B,iBAC1BA,OAD0B;;AAElC,MAAMC,YAAY,GAAGJ,eAAe,EAApC;AACA,MAAMK,sBAAsB,GAAGN,yBAAyB,EAAxD;AAEA,SAAOE,WAAW;AAAA,wEAChB,iBAAOK,MAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACoBD,sBAAsB,CAACE,MAAvB,CAA8BH,YAA9B,CADpB;;AAAA;AACQI,cAAAA,GADR;AAEQC,cAAAA,aAFR,GAEwBD,GAAG,CAACE,MAF5B;AAIQC,cAAAA,cAJR,GAIyB,IAAIhB,QAAJ,CACrBc,aADqB,EAErBX,YAFqB,EAGrBK,OAAO,CAACS,SAAR,EAHqB,CAJzB;AAUQC,cAAAA,YAVR,GAUuBjB,UAAU,CAACkB,MAAM,CAACR,MAAD,CAAP,EAAiB,EAAjB,CAVjC;AAAA;AAAA;AAAA,qBAc8BK,cAAc,CAACI,WAAf,CAA2BC,MAA3B,CACxBH,YAAY,CAACI,QAAb,EADwB,CAd9B;;AAAA;AAcUF,cAAAA,WAdV;AAiBIG,cAAAA,QAAQ,GAAG,CAACC,UAAU,CAACJ,WAAW,CAACE,QAAZ,EAAD,CAAV,GAAqC,GAAtC,EAA2CG,OAA3C,CAAmD,CAAnD,CAAX;AAjBJ;AAAA;;AAAA;AAAA;AAAA;AAmBIF,cAAAA,QAAQ,GAAG,OAAX;;AAnBJ;AAAA,+CAsBSP,cAAc,CAACK,MAAf,CAAsBH,YAAY,CAACI,QAAb,EAAtB,EAA+C;AACpDC,gBAAAA,QAAQ,EAARA;AADoD,eAA/C,CAtBT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADgB;;AAAA;AAAA;AAAA;AAAA,OA2BhB,CAACd,YAAD,EAAeC,sBAAf,CA3BgB,CAAlB;AA6BD;;GAlCuBH,S;UACFL,Y,EACCG,e,EACUD,yB","sourcesContent":["import { Contract } from \"@ethersproject/contracts\";\nimport type { TransactionResponse } from \"@ethersproject/providers\";\nimport { parseUnits } from \"@ethersproject/units\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport U_TOKENT_ABI from \"constants/abis/uToken.json\";\nimport useMarketRegistryContract from \"hooks/contracts/useMarketRegistryContract\";\nimport useCurrentToken from \"hooks/useCurrentToken\";\nimport { useCallback } from \"react\";\n\nexport default function useBorrow() {\n  const { library } = useWeb3React();\n  const tokenAddress = useCurrentToken();\n  const marketRegistryContract = useMarketRegistryContract();\n\n  return useCallback(\n    async (amount: number | string): Promise<TransactionResponse> => {\n      const res = await marketRegistryContract.tokens(tokenAddress);\n      const uTokenAddress = res.uToken;\n\n      const uTokenContract = new Contract(\n        uTokenAddress,\n        U_TOKENT_ABI,\n        library.getSigner()\n      );\n\n      const borrowAmount = parseUnits(String(amount), 18);\n\n      let gasLimit: any;\n      try {\n        const estimateGas = await uTokenContract.estimateGas.borrow(\n          borrowAmount.toString()\n        );\n        gasLimit = (parseFloat(estimateGas.toString()) * 1.1).toFixed(0);\n      } catch (err) {\n        gasLimit = 1000000;\n      }\n\n      return uTokenContract.borrow(borrowAmount.toString(), {\n        gasLimit,\n      });\n    },\n    [tokenAddress, marketRegistryContract]\n  );\n}\n"]},"metadata":{},"sourceType":"module"}